# è‡ªåŠ¨åŒ–ä»»åŠ¡ç”Ÿæˆå™¨ GUI å®æ–½è®¡åˆ’

## é¡¹ç›®æ¦‚è¿°

åˆ›å»ºä¸€ä¸ªåŸºäº CustomTkinter çš„å¯è§†åŒ–è‡ªåŠ¨åŒ–ä»»åŠ¡é…ç½®å·¥å…·ï¼Œå¤ç”¨ç°æœ‰ [`auto_signin.py`](../auto_signin.py) ä¸­çš„æ ¸å¿ƒç±»ï¼ˆImageFinderã€HumanMouseã€WxPushï¼‰ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ç‚¹å‡»æ–¹å¼é…ç½®è‡ªåŠ¨åŒ–æ­¥éª¤ï¼Œå¹¶ç”Ÿæˆå¯æ‰§è¡Œçš„ Python ä»£ç ã€‚

## æ¶æ„è®¾è®¡

```mermaid
graph TB
    subgraph GUI Layer
        A[MainWindow] --> B[ToolBar]
        A --> C[StepTypePanel]
        A --> D[StepListPanel]
        A --> E[PropertyEditor]
        A --> F[CodePreview]
    end
    
    subgraph Data Layer
        G[Step] --> H[StepManager]
        H --> I[TaskConfig]
    end
    
    subgraph Generator Layer
        J[CodeGenerator]
        K[TemplateEngine]
    end
    
    D --> H
    E --> G
    F --> J
    J --> K
    I --> J
```

## æ–‡ä»¶ç»“æ„

```
æ–°å»ºæ–‡ä»¶å¤¹/
â”œâ”€â”€ auto_task_gui.py          # ä¸» GUI ç¨‹åº [æ–°å»º]
â”œâ”€â”€ task_templates/           # ä»£ç æ¨¡æ¿ç›®å½• [æ–°å»º]
â”‚   â””â”€â”€ base_template.py      # åŸºç¡€æ¨¡æ¿
â”œâ”€â”€ tasks/                    # ä¿å­˜çš„ä»»åŠ¡é…ç½® [æ–°å»º]
â”‚   â””â”€â”€ example.json          # ç¤ºä¾‹é…ç½®
â”œâ”€â”€ auto_signin.py            # ç°æœ‰ç­¾åˆ°è„šæœ¬ [å¤ç”¨]
â”œâ”€â”€ capture_tool.py           # ç°æœ‰æˆªå›¾å·¥å…· [å¤ç”¨]
â””â”€â”€ images/                   # å›¾ç‰‡ç´ æ
```

## æ ¸å¿ƒç±»è®¾è®¡

### 1. Step æ•°æ®ç±»

```python
@dataclass
class Step:
    id: str                    # å”¯ä¸€æ ‡è¯†
    step_type: str             # æ­¥éª¤ç±»å‹
    params: dict               # å‚æ•°å­—å…¸
    enabled: bool = True       # æ˜¯å¦å¯ç”¨
```

### 2. StepManager æ­¥éª¤ç®¡ç†å™¨

```python
class StepManager:
    steps: List[Step]
    
    def add_step(step_type: str) -> Step
    def remove_step(step_id: str) -> bool
    def move_step(step_id: str, direction: int) -> bool
    def update_step(step_id: str, params: dict) -> bool
    def get_step(step_id: str) -> Step
```

### 3. TaskConfig ä»»åŠ¡é…ç½®

```python
class TaskConfig:
    name: str
    description: str
    steps: List[Step]
    settings: dict
    
    def save(filepath: str) -> bool
    def load(filepath: str) -> TaskConfig
    def to_dict() -> dict
```

### 4. CodeGenerator ä»£ç ç”Ÿæˆå™¨

```python
class CodeGenerator:
    def generate_step_code(step: Step) -> str
    def generate_full_code(config: TaskConfig) -> str
    def get_imports() -> str
```

## æ­¥éª¤ç±»å‹å®šä¹‰

| ç±»å‹ | å›¾æ ‡ | å‚æ•° | ç”Ÿæˆä»£ç ç¤ºä¾‹ |
|------|------|------|-------------|
| click_image | ğŸ“Œ | image_path, confidence, timeout | `finder.wait_for_image(...); mouse.click(...)` |
| wait_image | â³ | image_path, confidence, timeout | `finder.wait_for_image(...)` |
| input_text | âŒ¨ï¸ | text, clear_first | `pyautogui.write(...)` |
| wait_time | â±ï¸ | seconds | `time.sleep(...)` |
| open_url | ğŸŒ | url | `webbrowser.open(...)` |
| clipboard_get | ğŸ“‹ | var_name | `var = pyperclip.paste()` |
| clipboard_set | ğŸ“‹ | content | `pyperclip.copy(...)` |
| ocr_region | ğŸ”¤ | x, y, width, height, var_name | `ocr_screen_region(...)` |
| press_key | âŒ¨ï¸ | key, modifiers | `pyautogui.hotkey(...)` |
| condition | â“ | expression, true_steps, false_steps | `if ...: ...` |
| loop | ğŸ”„ | count/condition, sub_steps | `for i in range(...): ...` |
| wx_push | ğŸ“± | title, content, token | `WxPush.send(...)` |

## GUI å¸ƒå±€è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [æ–°å»º] [æ‰“å¼€] [ä¿å­˜] [è¿è¡Œ] [ç”Ÿæˆä»£ç ]              å·¥å…·æ            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  â”‚                                                  â”‚
â”‚   æ­¥éª¤ç±»å‹é¢æ¿    â”‚              æ­¥éª¤åˆ—è¡¨åŒºåŸŸ                         â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   ğŸ“Œ ç‚¹å‡»å›¾ç‰‡     â”‚   â”‚ â˜‘ 1. [æ‰“å¼€URL] https://example.com     â”‚    â”‚
â”‚   â³ ç­‰å¾…å›¾ç‰‡     â”‚   â”‚ â˜‘ 2. [ç­‰å¾…] 3ç§’                        â”‚    â”‚
â”‚   âŒ¨ï¸ è¾“å…¥æ–‡æœ¬     â”‚   â”‚ â˜‘ 3. [ç‚¹å‡»å›¾ç‰‡] login_btn.png          â”‚    â”‚
â”‚   â±ï¸ ç­‰å¾…æ—¶é—´     â”‚   â”‚ â˜ 4. [è¾“å…¥æ–‡æœ¬] username               â”‚    â”‚
â”‚   ğŸŒ æ‰“å¼€URL     â”‚   â”‚    [â†‘] [â†“] [åˆ é™¤]                      â”‚    â”‚
â”‚   ğŸ“‹ å‰ªè´´æ¿æ“ä½œ   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚   ğŸ”¤ OCRè¯†åˆ«     â”‚                                                  â”‚
â”‚   âŒ¨ï¸ æŒ‰é”®æ“ä½œ     â”‚              æ­¥éª¤å±æ€§ç¼–è¾‘åŒº                       â”‚
â”‚   â“ æ¡ä»¶åˆ¤æ–­     â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   ğŸ”„ å¾ªç¯        â”‚   â”‚ å›¾ç‰‡è·¯å¾„: [________________] [æµè§ˆ]     â”‚    â”‚
â”‚   ğŸ“± å¾®ä¿¡æ¨é€     â”‚   â”‚ ç½®ä¿¡åº¦:   [0.8_____________]           â”‚    â”‚
â”‚                  â”‚   â”‚ è¶…æ—¶:     [30______________] ç§’        â”‚    â”‚
â”‚                  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        ä»£ç é¢„è§ˆåŒºåŸŸ                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ # è‡ªåŠ¨ç”Ÿæˆçš„ä»£ç                                                 â”‚ â”‚
â”‚  â”‚ import time, webbrowser                                        â”‚ â”‚
â”‚  â”‚ def step1_open_url():                                          â”‚ â”‚
â”‚  â”‚     webbrowser.open('https://example.com')                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## JSON é…ç½®æ ¼å¼

```json
{
  "name": "ç¤ºä¾‹ä»»åŠ¡",
  "description": "è‡ªåŠ¨ç­¾åˆ°æµç¨‹",
  "version": "1.0",
  "settings": {
    "default_confidence": 0.8,
    "default_timeout": 30
  },
  "steps": [
    {
      "id": "step_001",
      "type": "open_url",
      "enabled": true,
      "params": {
        "url": "https://example.com"
      }
    },
    {
      "id": "step_002",
      "type": "wait_time",
      "enabled": true,
      "params": {
        "seconds": 3
      }
    }
  ]
}
```

## å®æ–½æ­¥éª¤

### é˜¶æ®µ 1: åŸºç¡€æ¡†æ¶
1. åˆ›å»ºç›®å½•ç»“æ„ `task_templates/` å’Œ `tasks/`
2. åˆ›å»ºæ•°æ®æ¨¡å‹ (`Step`, `StepManager`, `TaskConfig`)
3. åˆ›å»ºä¸»çª—å£æ¡†æ¶å’ŒåŸºæœ¬å¸ƒå±€

### é˜¶æ®µ 2: GUI ç»„ä»¶
4. å®ç°æ­¥éª¤ç±»å‹é¢æ¿ï¼ˆå·¦ä¾§å¯ç‚¹å‡»æŒ‰é’®åˆ—è¡¨ï¼‰
5. å®ç°æ­¥éª¤åˆ—è¡¨åŒºåŸŸï¼ˆå¯é€‰æ‹©ã€æ’åºçš„åˆ—è¡¨ï¼‰
6. å®ç°æ­¥éª¤å±æ€§ç¼–è¾‘åŒºï¼ˆåŠ¨æ€è¡¨å•ï¼‰
7. å®ç°ä»£ç é¢„è§ˆåŒºåŸŸï¼ˆåªè¯»æ–‡æœ¬æ¡†ï¼‰

### é˜¶æ®µ 3: åŠŸèƒ½å®ç°
8. å®ç°å·¥å…·æ åŠŸèƒ½ï¼ˆæ–°å»º/æ‰“å¼€/ä¿å­˜/è¿è¡Œ/ç”Ÿæˆä»£ç ï¼‰
9. åˆ›å»ºä»£ç ç”Ÿæˆå™¨å’Œæ¨¡æ¿å¼•æ“
10. å®ç°é…ç½®çš„ä¿å­˜å’ŒåŠ è½½

### é˜¶æ®µ 4: å®Œå–„
11. æ·»åŠ å›¾ç‰‡æµè§ˆå™¨å¯¹è¯æ¡†
12. æ·»åŠ é”™è¯¯å¤„ç†å’ŒéªŒè¯
13. æµ‹è¯•å’Œè°ƒè¯•

## ä¾èµ–é¡¹

```bash
pip install customtkinter
# ç°æœ‰ä¾èµ–ï¼ˆå·²å®‰è£…ï¼‰
pip install pyautogui pillow opencv-python pyperclip requests easyocr
```

## ä¸ç°æœ‰ä»£ç çš„é›†æˆ

- å¤ç”¨ [`auto_signin.py`](../auto_signin.py) ä¸­çš„ `ImageFinder` ç±»è¿›è¡Œå›¾ç‰‡åŒ¹é…
- å¤ç”¨ `HumanMouse` ç±»è¿›è¡Œé¼ æ ‡æ“ä½œ
- å¤ç”¨ `WxPush` ç±»è¿›è¡Œå¾®ä¿¡æ¨é€
- å¤ç”¨ OCR ç›¸å…³å‡½æ•°

ç”Ÿæˆçš„ä»£ç å°†å¯¼å…¥è¿™äº›ç°æœ‰ç±»ï¼Œç¡®ä¿ä»£ç å¤ç”¨å’Œä¸€è‡´æ€§ã€‚
